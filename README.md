# 3 - Классы в C++. Работа с файлами, массивами объектов и алгоритмами обработки данных <!-- omit in toc -->

> Лабораторная работа 3 для студентов курса "Программирование на основе классов и шаблонов" 2 семестра кафедры ИУ5 МГТУ им Н.Э. Баумана.

## Содержание <!-- omit in toc -->

- [Цель работы](#цель-работы)
- [Начало работы](#начало-работы)
- [Задание](#задание)
- [Указания по выполнению лабораторной работы](#указания-по-выполнению-лабораторной-работы)
	- [Общие советы](#общие-советы)
	- [Рекомендуемая структура меню программы](#рекомендуемая-структура-меню-программы)
	- [Требования к реализации](#требования-к-реализации)
- [Пример программы, использующей класс Planet](#пример-программы-использующей-класс-planet)
- [Требования к отчёту](#требования-к-отчёту)
- [Контрольные вопросы](#контрольные-вопросы)

## Цель работы

Цель данной лабораторной работы заключается в освоении навыков:

- работы с файлами в языке C++ (текстовые файлы);
- сохранения и загрузки объектов пользовательских типов;
- обработки массивов объектов (добавление и удаление элементов);
- сортировки массива объектов по заданному критерию;
- поиска объектов по заданным параметрам (для студентов с повышенным уровнем подготовки);
- редактирования данных объектов (для студентов с повышенным уровнем подготовки);
- применения принципов объектно-ориентированного программирования и стандарта **C++20+**.

---

## Начало работы

Зайдите в свою локальную директорию с репозиторием для выполнения лабораторных работ. Заберите ветку с соответствующей лабораторной работой из общего репозитория:

```sh
git pull upstream
```

**или**

```sh
git pull upstream lab_1
```

Переключитесь на ветку с текущей лабораторной работой:

```sh
git checkout lab_1
```

Свяжите ветку локального репозитория с вашим удаленным репозиторием:

```sh
git push --set-upstream origin lab_1
```

## Задание

1. Используя класс, разработанный в предыдущей лабораторной работе, расширьте программу следующими возможностями:

2. Реализуйте сохранение массива объектов в текстовый файл.

3. Реализуйте загрузку массива объектов из текстового файла.

4. Реализуйте добавление нового объекта в массив.

5. Реализуйте удаление объекта из массива по заданному критерию (например, по имени или идентификатору).

6. Реализуйте сортировку массива объектов по одному из полей класса.

7. *(Для сильных студентов)* Реализуйте поиск объекта по заданному параметру.

8. *(Для сильных студентов)* Реализуйте редактирование данных выбранного объекта.

---
## Указания по выполнению лабораторной работы

### Общие советы

- Используйте стандарт **C++20 или выше**.
- Класс должен быть разработан в соответствии с требованиями предыдущей лабораторной работы (инкапсуляция, Rule of Five).
- **Использование** `std::string` **запрещено**; допускается работа только с C-строками.
- Все операции с массивом объектов должны быть корректными и безопасными.
- Работа с файлами должна сопровождаться проверкой успешного открытия файла.
- В данной лабораторной работе обязательно использование идиомы [copy-and-swap](https://fitoliaka.github.io/OOP/Style%20Guide.html#copy-and-swap) при реализации оператора присваивания.

---

### Рекомендуемая структура меню программы

1. Загрузка данных из файла
2. Сохранение данных в файл
3. Добавление объекта
4. Удаление объекта
5. Сортировка массива
6. Поиск объекта *(дополнительно)*
7. Редактирование объекта *(дополнительно)*
8. Вывод массива на экран
9. Выход

---

### Требования к реализации

- Размер массива объектов должен быть динамическим задаётся константой.
- При добавлении элементов контролировать переполнение массиваи если надо предусмотреть возможность расширить его.
- При удалении элементов обеспечивать корректное смещение массива.
- Для сортировкииспользовать свою библиотеку .
- Поиск реализовать линейным алгоритмом.
- Код должен быть модульным и хорошо структурированным.

---

## Пример программы, использующей класс Planet

```cpp
#include <iostream>
#include <fstream>

class Planet {
private:
char* name;
double mass;

public:
// Конструкторы и деструктор
Planet() noexcept;
explicit Planet(const char* name, double mass);
Planet(const Planet& other);
Planet(Planet&& other) noexcept;
~Planet();

// Операторы присваивания (copy-and-swap)
Planet& operator=(Planet other) noexcept;

// Методы доступа
const char* getName() const;
double getMass() const;
void setName(const char* name);
void setMass(double mass);

// Перегрузка потокового ввода-вывода
friend std::ostream& operator<<(std::ostream& os, const Planet& p);
friend std::istream& operator>>(std::istream& is, Planet& p);
};
```

```cpp
#include <iostream>
#include "Planet.h"

namespace{
	constexpr int previewSize = 10;
}

void showMenu();
void loadFromFile(Planet* planets, int& size);
void saveToFile(const Planet* planets, int size);
void addPlanet(Planet* planets, int& size);
void removePlanet(Planet* planets, int& size);
void sortPlanets(Planet* planets, int size);

// Дополнительные задания (для сильных студентов)
int findPlanet(const Planet* planets, int size);
void editPlanet(Planet* planets, int size);

int startApp() {
	Planet* planets = new Planet[preview Size];
	int size = 0;
	int choice = 1;

	while (choice != 9){
	showMenu();
	std::cin >> choice;

	switch (choice) {
		case 1:
			loadFromFile(planets, size);
			break;
		case 2:
			saveToFile(planets, size);
			break;
		case 3:
			addPlanet(planets, size);
			break;
		case 4:
			removePlanet(planets, size);
			break;
		case 5:
			sortPlanets(planets, size);
			break;
		case 6:
			findPlanet(planets, size); // дополнительно
			break;
		case 7:
			editPlanet(planets, size); // дополнительно
			break;
		case 8:
			// вывод массива
		break;
	}
}

return 0;
}
```

---

## Требования к отчёту

Отчёт по лабораторной работе должен содержать:

- Титульный лист с указанием дисциплины, номера лабораторной работы, ФИО студента и группы.
- Цель лабораторной работы.
- Формулировку задания и номер варианта.
- Теоретические сведения по теме работы (выполняются рукописно, разборчивым почерком, на отдельном листе бумаги).
- Описание структуры проекта и используемых файлов.
- Исходный код.
- Результаты выполнения программы (скриншоты или вывод в консоль, текстовые файлы).
- Выводы по результатам выполненной работы.

---

## Контрольные вопросы

1. Какие классы используются для работы с файлами в C++?
2. В чём отличие текстового и бинарного файла?
3. Как сохранить объект пользовательского типа в файл?
4. Какие способы сортировки массивов вы знаете?
5. Как выполняется удаление элемента из массива объектов?
6. Что такое линейный поиск?
7. Как обеспечить корректное редактирование объекта в массиве?
8. Какие ошибки могут возникать при работе с файлами?
9. Что такое `explicit` в C++?
10. Как работает `noexcept` в c++?
11. Идиома `Copy-and-Swap` в С++

---
